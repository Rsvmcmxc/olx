/*! iFrame Resizer (iframeSizer.contentWindow.min.js) - v4.2.11 - 2020-06-02
 *  Desc: Include this file in any page being loaded into an iframe
 *        to force the iframe to resize to the content size.
 *  Requires: iframeResizer.min.js on host page.
 *  Copyright: (c) 2020 David J. Bradshaw - dave@bradshaw.net
 *  License: MIT
 */(function(s){if(typeof window<"u"){var g=!0,Le=10,re="",F=0,R="",J=null,ae="",x=!1,Pe={resize:1,click:1},U=128,ue=!0,L=1,Q="bodyOffset",d=Q,ce=!0,se="",M={},b=32,le=null,_=!1,P="[iFrameSizer]",de=P.length,D="",fe={max:1,min:1,bodyScroll:1,documentElementScroll:1},V="child",De=!0,me=window.parent,I="*",K=0,j=!1,he=null,q=16,H=1,ge="scroll",m=ge,je=window,Y=function(){y("onMessage function not defined")},G=function(){},X=function(){},$={height:function(){return y("Custom height calculation function not defined"),document.documentElement.offsetHeight},width:function(){return y("Custom width calculation function not defined"),document.body.scrollWidth}},Z={},pe=!1;try{var ve=Object.create({},{passive:{get:function(){pe=!0}}});window.addEventListener("test",ye,ve),window.removeEventListener("test",ye,ve)}catch{}var ee,N,A,te,p,z,W=Date.now||function(){return new Date().getTime()},v={bodyOffset:function(){return document.body.offsetHeight+oe("marginTop")+oe("marginBottom")},offset:function(){return v.bodyOffset()},bodyScroll:function(){return document.body.scrollHeight},custom:function(){return $.height()},documentElementOffset:function(){return document.documentElement.offsetHeight},documentElementScroll:function(){return document.documentElement.scrollHeight},max:function(){return Math.max.apply(null,B(v))},min:function(){return Math.min.apply(null,B(v))},grow:function(){return v.max()},lowestElement:function(){return Math.max(v.bodyOffset()||v.documentElementOffset(),ie("bottom",Ae()))},taggedElement:function(){return Ne("bottom","data-iframe-height")}},T={bodyScroll:function(){return document.body.scrollWidth},bodyOffset:function(){return document.body.offsetWidth},custom:function(){return $.width()},documentElementScroll:function(){return document.documentElement.scrollWidth},documentElementOffset:function(){return document.documentElement.offsetWidth},scroll:function(){return Math.max(T.bodyScroll(),T.documentElementScroll())},max:function(){return Math.max.apply(null,B(T))},min:function(){return Math.min.apply(null,B(T))},rightMostElement:function(){return ie("right",Ae())},taggedElement:function(){return Ne("right","data-iframe-width")}},qe=(ee=ze,p=null,z=0,function(){var e=W(),t=q-(e-(z=z||e));return N=this,A=arguments,t<=0||q<t?(p&&(clearTimeout(p),p=null),z=e,te=ee.apply(N,A),p||(N=A=null)):p=p||setTimeout(Be,t),te});C(window,"message",function(e){var t={init:function(){se=e.data,me=e.source,He(),ue=!1,setTimeout(function(){ce=!1},U)},reset:function(){ce?o("Page reset ignored by init"):(o("Page size reset by host page"),ke("resetPage"))},resize:function(){E("resizeParent","Parent window requested size check")},moveToAnchor:function(){M.findTarget(i())},inPageLink:function(){this.moveToAnchor()},pageInfo:function(){var a=i();o("PageInfoFromParent called from parent: "+a),X(JSON.parse(a)),o(" --")},message:function(){var a=i();o("onMessage called from parent: "+a),Y(JSON.parse(a)),o(" --")}};function n(){return e.data.split("]")[1].split(":")[0]}function i(){return e.data.substr(e.data.indexOf(":")+1)}function r(){return e.data.split(":")[2]in{true:1,false:1}}function u(){var a=n();a in t?t[a]():(typeof module>"u"||!module.exports)&&"iFrameResize"in window||"jQuery"in window&&"iFrameResize"in window.jQuery.prototype||r()||y("Unexpected message ("+e.data+")")}P===(""+e.data).substr(0,de)&&(ue===!1?u():r()?t.init():o('Ignored message of type "'+n()+'". Received before initialization.'))}),C(window,"readystatechange",xe),xe()}function ye(){}function C(e,t,n,i){e.addEventListener(t,n,!!pe&&(i||{}))}function we(e){return e.charAt(0).toUpperCase()+e.slice(1)}function be(e){return P+"["+D+"] "+e}function o(e){_&&typeof window.console=="object"&&console.log(be(e))}function y(e){typeof window.console=="object"&&console.warn(be(e))}function He(){(function(){function e(n){return n==="true"}var t=se.substr(de).split(":");D=t[0],F=s!==t[1]?Number(t[1]):F,x=s!==t[2]?e(t[2]):x,_=s!==t[3]?e(t[3]):_,b=s!==t[4]?Number(t[4]):b,g=s!==t[6]?e(t[6]):g,R=t[7],d=s!==t[8]?t[8]:d,re=t[9],ae=t[10],K=s!==t[11]?Number(t[11]):K,M.enable=s!==t[12]&&e(t[12]),V=s!==t[13]?t[13]:V,m=s!==t[14]?t[14]:m})(),o("Initialising iFrame ("+location.href+")"),function(){function e(t,n){return typeof t=="function"&&(o("Setup custom "+n+"CalcMethod"),$[n]=t,t="custom"),t}"iFrameResizer"in window&&Object===window.iFrameResizer.constructor&&(function(){var t=window.iFrameResizer;o("Reading data from page: "+JSON.stringify(t)),Object.keys(t).forEach(We,t),Y="onMessage"in t?t.onMessage:Y,G="onReady"in t?t.onReady:G,I="targetOrigin"in t?t.targetOrigin:I,d="heightCalculationMethod"in t?t.heightCalculationMethod:d,m="widthCalculationMethod"in t?t.widthCalculationMethod:m}(),d=e(d,"height"),m=e(m,"width")),o("TargetOrigin for parent set to: "+I)}(),function(){s===R&&(R=F+"px"),ne("margin",function(e,t){return t.indexOf("-")!==-1&&(y("Negative CSS value ignored for "+e),t=""),t}("margin",R))}(),ne("background",re),ne("padding",ae),function(){var e=document.createElement("div");e.style.clear="both",e.style.display="block",e.style.height="0",document.body.appendChild(e)}(),Oe(),Se(),document.documentElement.style.height="",document.body.style.height="",o('HTML & body height set to "auto"'),o("Enable public methods"),je.parentIFrame={autoResize:function(e){return e===!0&&g===!1?(g=!0,Me()):e===!1&&g===!0&&(g=!1,Te("remove"),J!==null&&J.disconnect(),clearInterval(le)),h(0,0,"autoResize",JSON.stringify(g)),g},close:function(){h(0,0,"close")},getId:function(){return D},getPageInfo:function(e){typeof e=="function"?(X=e,h(0,0,"pageInfo")):(X=function(){},h(0,0,"pageInfoStop"))},moveToAnchor:function(e){M.findTarget(e)},reset:function(){Re("parentIFrame.reset")},scrollTo:function(e,t){h(t,e,"scrollTo")},scrollToOffset:function(e,t){h(t,e,"scrollToOffset")},sendMessage:function(e,t){h(0,0,"message",JSON.stringify(e),t)},setHeightCalculationMethod:function(e){d=e,Oe()},setWidthCalculationMethod:function(e){m=e,Se()},setTargetOrigin:function(e){o("Set targetOrigin: "+e),I=e},size:function(e,t){E("size","parentIFrame.size("+((e||"")+(t?","+t:""))+")",e,t)}},Me(),M=function(){function e(r){var u=r.getBoundingClientRect(),a={x:window.pageXOffset!==s?window.pageXOffset:document.documentElement.scrollLeft,y:window.pageYOffset!==s?window.pageYOffset:document.documentElement.scrollTop};return{x:parseInt(u.left,10)+parseInt(a.x,10),y:parseInt(u.top,10)+parseInt(a.y,10)}}function t(r){var u,a=r.split("#")[1]||r,f=decodeURIComponent(a),w=document.getElementById(f)||document.getElementsByName(f)[0];s!==w?(u=e(w),o("Moving to in page link (#"+a+") at x: "+u.x+" y: "+u.y),h(u.y,u.x,"scrollToOffset")):(o("In page link (#"+a+") not found in iFrame, so sending to parent"),h(0,0,"inPageLink","#"+a))}function n(){location.hash!==""&&location.hash!=="#"&&t(location.href)}function i(){Array.prototype.forEach.call(document.querySelectorAll('a[href^="#"]'),function(r){r.getAttribute("href")!=="#"&&C(r,"click",function(u){u.preventDefault(),t(this.getAttribute("href"))})})}return M.enable?Array.prototype.forEach&&document.querySelectorAll?(o("Setting up location.hash handlers"),i(),C(window,"hashchange",n),setTimeout(n,U)):y("In page linking not fully supported in this browser! (See README.md for IE8 workaround)"):o("In page linking not enabled"),{findTarget:t}}(),E("init","Init message from host page"),G()}function We(e){var t=e.split("Callback");if(t.length===2){var n="on"+t[0].charAt(0).toUpperCase()+t[0].slice(1);this[n]=this[e],delete this[e],y("Deprecated: '"+e+"' has been renamed '"+n+"'. The old method will be removed in the next major version.")}}function ne(e,t){s!==t&&t!==""&&t!=="null"&&o("Body "+e+' set to "'+(document.body.style[e]=t)+'"')}function l(e){var t={add:function(n){function i(){E(e.eventName,e.eventType)}Z[n]=i,C(window,n,i,{passive:!0})},remove:function(n){var i=Z[n];delete Z[n],function(r,u,a){r.removeEventListener(u,a,!1)}(window,n,i)}};e.eventNames&&Array.prototype.map?(e.eventName=e.eventNames[0],e.eventNames.map(t[e.method])):t[e.method](e.eventName),o(we(e.method)+" event listener: "+e.eventType)}function Te(e){l({method:e,eventType:"Animation Start",eventNames:["animationstart","webkitAnimationStart"]}),l({method:e,eventType:"Animation Iteration",eventNames:["animationiteration","webkitAnimationIteration"]}),l({method:e,eventType:"Animation End",eventNames:["animationend","webkitAnimationEnd"]}),l({method:e,eventType:"Input",eventName:"input"}),l({method:e,eventType:"Mouse Up",eventName:"mouseup"}),l({method:e,eventType:"Mouse Down",eventName:"mousedown"}),l({method:e,eventType:"Orientation Change",eventName:"orientationchange"}),l({method:e,eventType:"Print",eventName:["afterprint","beforeprint"]}),l({method:e,eventType:"Ready State Change",eventName:"readystatechange"}),l({method:e,eventType:"Touch Start",eventName:"touchstart"}),l({method:e,eventType:"Touch End",eventName:"touchend"}),l({method:e,eventType:"Touch Cancel",eventName:"touchcancel"}),l({method:e,eventType:"Transition Start",eventNames:["transitionstart","webkitTransitionStart","MSTransitionStart","oTransitionStart","otransitionstart"]}),l({method:e,eventType:"Transition Iteration",eventNames:["transitioniteration","webkitTransitionIteration","MSTransitionIteration","oTransitionIteration","otransitioniteration"]}),l({method:e,eventType:"Transition End",eventNames:["transitionend","webkitTransitionEnd","MSTransitionEnd","oTransitionEnd","otransitionend"]}),V==="child"&&l({method:e,eventType:"IFrame Resized",eventName:"resize"})}function Ee(e,t,n,i){return t!==e&&(e in n||(y(e+" is not a valid option for "+i+"CalculationMethod."),e=t),o(i+' calculation method set to "'+e+'"')),e}function Oe(){d=Ee(d,Q,v,"height")}function Se(){m=Ee(m,ge,T,"width")}function Me(){g===!0?(Te("add"),function(){var e=b<0;window.MutationObserver||window.WebKitMutationObserver?e?Ie():J=function(){function t(c){function S(O){O.complete===!1&&(o("Attach listeners to "+O.src),O.addEventListener("load",r,!1),O.addEventListener("error",u,!1),f.push(O))}c.type==="attributes"&&c.attributeName==="src"?S(c.target):c.type==="childList"&&Array.prototype.forEach.call(c.target.querySelectorAll("img"),S)}function n(c){o("Remove listeners from "+c.src),c.removeEventListener("load",r,!1),c.removeEventListener("error",u,!1),function(S){f.splice(f.indexOf(S),1)}(c)}function i(c,S,O){n(c.target),E(S,O+": "+c.target.src,s,s)}function r(c){i(c,"imageLoad","Image loaded")}function u(c){i(c,"imageLoadFailed","Image load failed")}function a(c){E("mutationObserver","mutationObserver: "+c[0].target+" "+c[0].type),c.forEach(t)}var f=[],w=window.MutationObserver||window.WebKitMutationObserver,k=function(){var c=document.querySelector("body");return k=new w(a),o("Create body MutationObserver"),k.observe(c,{attributes:!0,attributeOldValue:!1,characterData:!0,characterDataOldValue:!1,childList:!0,subtree:!0}),k}();return{disconnect:function(){"disconnect"in k&&(o("Disconnect body MutationObserver"),k.disconnect(),f.forEach(n))}}}():(o("MutationObserver not supported in this browser!"),Ie())}()):o("Auto Resize disabled")}function Ie(){b!==0&&(o("setInterval: "+b+"ms"),le=setInterval(function(){E("interval","setInterval: "+b)},Math.abs(b)))}function oe(e,t){var n=0;return t=t||document.body,n=(n=document.defaultView.getComputedStyle(t,null))!==null?n[e]:0,parseInt(n,Le)}function ie(e,t){for(var n=t.length,i=0,r=0,u=we(e),a=W(),f=0;f<n;f++)r<(i=t[f].getBoundingClientRect()[e]+oe("margin"+u,t[f]))&&(r=i);return a=W()-a,o("Parsed "+n+" HTML elements"),o("Element position calculated in "+a+"ms"),function(w){q/2<w&&o("Event throttle increased to "+(q=2*w)+"ms")}(a),r}function B(e){return[e.bodyOffset(),e.bodyScroll(),e.documentElementOffset(),e.documentElementScroll()]}function Ne(e,t){var n=document.querySelectorAll("["+t+"]");return n.length===0&&(y("No tagged elements ("+t+") found on page"),document.querySelectorAll("body *")),ie(e,n)}function Ae(){return document.querySelectorAll("body *")}function ze(e,t,n,i){var r,u;function a(f,w){return!(Math.abs(f-w)<=K)}r=s!==n?n:v[d](),u=s!==i?i:T[m](),a(L,r)||x&&a(H,u)||e==="init"?(Ce(),h(L=r,H=u,e)):e in{init:1,interval:1,size:1}||!(d in fe||x&&m in fe)?e in{interval:1}||o("No change in size detected"):Re(t)}function Be(){z=W(),p=null,te=ee.apply(N,A),p||(N=A=null)}function E(e,t,n,i){j&&e in Pe?o("Trigger event cancelled: "+e):(e in{reset:1,resetPage:1,init:1}||o("Trigger event: "+t),e==="init"?ze(e,t,n,i):qe(e,t,n,i))}function Ce(){j||(j=!0,o("Trigger event lock on")),clearTimeout(he),he=setTimeout(function(){j=!1,o("Trigger event lock off"),o("--")},U)}function ke(e){L=v[d](),H=T[m](),h(L,H,e)}function Re(e){var t=d;d=Q,o("Reset trigger event: "+e),Ce(),ke("reset"),d=t}function h(e,t,n,i,r){var u;De===!0&&(s===r?r=I:o("Message targetOrigin: "+r),o("Sending message to host page ("+(u=D+":"+(e+":"+t)+":"+n+(s!==i?":"+i:""))+")"),me.postMessage(P+u,r))}function xe(){document.readyState!=="loading"&&window.parent.postMessage("[iFrameResizerChild]Ready","*")}})();
